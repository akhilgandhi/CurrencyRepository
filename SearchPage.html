<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Google Visualization API Sample</title>
    <!--
  One script tag loads all the required libraries! Do not specify any chart types in the
  autoload statement.
-->
    <script type="text/javascript" src='https://www.gstatic.com/charts/loader.js'></script>
    <script type="text/javascript">
        var ssId = '1SFbgvc3m2pcyX_VUWA5YJHGvBintNSBrh9xKzJ9sEoo';

    </script>
</head>

<body>

    <script>
        function initClient() {
            var API_KEY = 'AIzaSyDGrlgb2SkHgvGkvWqjlv_G3AAqq-v113M';  // TODO: Update placeholder with desired API key.

            var CLIENT_ID = '479573033148-kg28go1r68jchtrfppvmedt0v63sb6fq.apps.googleusercontent.com';  // TODO: Update placeholder with desired client ID.

            // TODO: Authorize using one of the following scopes:
            //   'https://www.googleapis.com/auth/drive'
            //   'https://www.googleapis.com/auth/drive.file'
            //   'https://www.googleapis.com/auth/drive.readonly'
            //   'https://www.googleapis.com/auth/spreadsheets'
            //   'https://www.googleapis.com/auth/spreadsheets.readonly'
            var SCOPE = "https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/spreadsheets";

            gapi.client.init({
                'apiKey': API_KEY,
                'clientId': CLIENT_ID,
                'scope': SCOPE,
                'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function () {
                gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);
                updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            });
        }

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function updateSignInStatus(isSignedIn) {
            if (isSignedIn) {
                google.charts.load('current', {
                    callback: function () {
                        document.getElementById('search').addEventListener('click', searchSheet, false);
                        searchSheet();

                        function searchSheet() {
                            searchText = document.getElementById('searchCurrency').value;

                            var queryToSelect = new google.visualization.Query('https://docs.google.com/spreadsheet/ccc?key=1SFbgvc3m2pcyX_VUWA5YJHGvBintNSBrh9xKzJ9sEoo&sheet=QUERY');
                            if (searchText !== '') {
                                queryToSelect.setQuery('select A, B, C where C like "%' + searchText + '%"');
                            }

                            queryToSelect.send(function (response) {
                                if (response.isError()) {
                                    console.log('Error in query : ' + response.getMessage() + ' ' + response.getDetailedMessage());
                                    return;
                                }

                                var dataTable = response.getDataTable();
                                for (var i = 0; i < dataTable.getNumberOfColumns(); i++) {
                                    document.getElementById(datatable.getColumnLabel(i)).value =
                                        (datatable.getNumberOfRows() > 0) ? datatable.getValue(0, i) : '';
                                }

                                var chart = new google.visualization.Table(document.getElementById('table_div'));
                                chart.draw(datatable);
                            });
                        }
                    },
                    packages: ['table']
                })
            }
        }

        function handleSignInClick(event) {
            gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignOutClick(event) {
            gapi.auth2.getAuthInstance().signOut();
        }
    </script>
    <script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()"
        onreadystatechange="if (this.readyState === 'complete') this.onload()">
        </script>
    <input id="searchCurrency" type="text" />
    <button id="search">Search</button>
    <input id="Date" type="text" />
    <input id="Denominations" type="text" />
    <input id="Currency Number" type="text" />

    <div id="table_div"></div>
</body>

</html>